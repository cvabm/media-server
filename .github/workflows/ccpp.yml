name: C/C++ CI

on: [push]

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout
        uses: actions/checkout@v2
        with:
          path: media-server

      - name: Sdk
        uses: actions/checkout@v2
        with:
          repository: ireader/sdk
          path: sdk
          
      - name: avcodec
        uses: actions/checkout@v2
        with:
          repository: ireader/avcodec
          path: avcodec

      - name: Make
        run: make
        working-directory: media-server
        
      - name: List generated files（推荐方式）
        run: |
          echo "=== 当前工作目录结构 ==="
          pwd
          ls -R
          
          echo "=== 只看 libmpeg 目录下的所有文件（包含子目录）==="
          find media-server/libmpeg -type f -print | sort
          
          echo "=== 只看编译生成的 .a/.so/.o 文件 ==="
          find media-server -name "*.a" -o -name "*.so" -o -name "*.o" | sort
        working-directory: .
